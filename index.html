<!DOCTYPE html>
<html>
<head>
<meta charset='UTF-8'>
<title>World Cup 2026 Schedule</title>
<style>
body{font-family:Arial;background:#0b1220;color:#fff}
button{margin:4px}
.match{padding:8px;border-bottom:1px solid #333}
.pagination{margin-top:10px}
</style>
</head>
<body>

<h2>Schedule</h2>
<button onclick='setScope("dallas")'>Dallas</button>
<button onclick='setScope("all")'>All Matches</button>

<input id='search' placeholder='Search team...' oninput='loadSchedule()'>

<div id='schedule'></div>
<div class='pagination' id='pager'></div>

<script>
let scope='dallas';
let page=1;
const PAGE_SIZE=10;

function to12h(t){
  if(!t)return '';
  const [h,m]=t.split(':').map(Number);
  const ap=h>=12?'PM':'AM';
  const hh=((h+11)%12)+1;
  return `${hh}:${m.toString().padStart(2,'0')} ${ap}`;
}

async function loadSchedule(){
  const q=document.getElementById('search').value;
  const res=await fetch(`/schedule.json?scope=${scope}&q=${encodeURIComponent(q)}`);
  const data=await res.json();

  const start=(page-1)*PAGE_SIZE;
  const pageMatches=data.matches.slice(start,start+PAGE_SIZE);

  const el=document.getElementById('schedule');
  el.innerHTML='';
  pageMatches.forEach(m=>{
    const d=document.createElement('div');
    d.className='match';
    d.innerHTML=`<b>${m.teams||'TBD'}</b><br>${m.date} • ${to12h(m.time||'')} • ${m.venue||''}`;
    el.appendChild(d);
  });

  renderPager(data.matches.length);
}

function renderPager(total){
  const pages=Math.ceil(total/PAGE_SIZE);
  const p=document.getElementById('pager');
  p.innerHTML='';
  if(pages<=1)return;

  if(page>1){
    const b=document.createElement('button');
    b.textContent='Prev';
    b.onclick=()=>{page--;loadSchedule()};
    p.appendChild(b);
  }

  p.append(` Page ${page} of ${pages} `);

  if(page<pages){
    const b=document.createElement('button');
    b.textContent='Next';
    b.onclick=()=>{page++;loadSchedule()};
    p.appendChild(b);
  }
}

function setScope(s){
  scope=s;
  page=1;
  loadSchedule();
}

loadSchedule();
</script>
</body>
</html>
